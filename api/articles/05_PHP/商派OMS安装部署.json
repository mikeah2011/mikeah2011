{"title":"商派OMS部署教程","uid":"d03c3cd3f9c2df37feee33aaa152319f","slug":"05_PHP/商派OMS安装部署","date":"2022-09-20T07:05:07.000Z","updated":"2022-11-11T02:05:33.705Z","comments":true,"path":"api/articles/05_PHP/商派OMS安装部署.json","keywords":null,"cover":null,"content":"<p>[TOC]</p>\n<h2 id=\"OMS本地环境部署-MacOS\"><a href=\"#OMS本地环境部署-MacOS\" class=\"headerlink\" title=\"OMS本地环境部署(MacOS)\"></a>OMS本地环境部署(MacOS)</h2><h3 id=\"初始化项目代码\"><a href=\"#初始化项目代码\" class=\"headerlink\" title=\"初始化项目代码\"></a>初始化项目代码</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">mkdir -p &#x2F;Users&#x2F;michael&#x2F;Project&#x2F;D1M\ncd &#x2F;Users&#x2F;michael&#x2F;Project&#x2F;D1M\ngit clone https:&#x2F;&#x2F;git.d1m.cn&#x2F;oms&#x2F;kering_oms.git</code></pre>\n\n\n\n<h3 id=\"使用brew安装服务环境\"><a href=\"#使用brew安装服务环境\" class=\"headerlink\" title=\"使用brew安装服务环境\"></a>使用<code>brew</code>安装服务环境</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">brew tap shivammathur&#x2F;php\nbrew install nginx redis mysql@5.7 shivammathur&#x2F;php&#x2F;php@5.6 imagemagick\nbrew services restart nginx mysql@5.7 redis php@5.6\nbrew services list</code></pre>\n\n\n\n<h3 id=\"使用pecl安装PHP扩展\"><a href=\"#使用pecl安装PHP扩展\" class=\"headerlink\" title=\"使用pecl安装PHP扩展\"></a>使用<code>pecl</code>安装PHP扩展</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">pecl i imagick curl gd mysql pdo pdo_mysql redis-3.1.6</code></pre>\n\n<p>下载指定系统环境的 <a href=\"https://www.zend.com/downloads/zend-guard-loader\">Zend Guard Loader扩展</a>，并解压，拷贝<code>.so</code>文件至扩展文件的所在路径</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">cp -rf &#x2F;Users&#x2F;michael&#x2F;Downloads&#x2F;zend-loader-php5.6-darwin10.7-x86_64&#x2F;*.so &#x2F;usr&#x2F;local&#x2F;opt&#x2F;php@5.6&#x2F;lib&#x2F;php&#x2F;20131226</code></pre>\n\n<p>找出<code>.ini</code>配置文件编辑，并添加以下内容</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">php -i | grep .ini\n# &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\nConfiguration File (php.ini) Path &#x3D;&gt; &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;5.6\nLoaded Configuration File &#x3D;&gt; &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;5.6&#x2F;php.ini\nScan this dir for additional .ini files &#x3D;&gt; &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;5.6&#x2F;conf.d\nAdditional .ini files parsed &#x3D;&gt; &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;5.6&#x2F;conf.d&#x2F;ext-opcache.ini\n# &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\n\nvim &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;5.6&#x2F;conf.d&#x2F;ext-opcache.ini\n# &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;以下&#x3D;&#x3D;&#x3D;为&#x3D;&#x3D;&#x3D;添加&#x3D;&#x3D;&#x3D;内容&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\n[opcache]\nzend_extension&#x3D;&#x2F;usr&#x2F;local&#x2F;opt&#x2F;php@5.6&#x2F;lib&#x2F;php&#x2F;20131226&#x2F;opcache.so\nzend_extension&#x3D;&#x2F;usr&#x2F;local&#x2F;opt&#x2F;php@5.6&#x2F;lib&#x2F;php&#x2F;20131226&#x2F;ZendGuardLoader.so\n\n;4. 可选：在php中添加附加行。用于启用ZendGuardLoader的ini\n; 启用加载编码脚本。默认值为On\nzend_loader.enable&#x3D;1\n     \n;5. 可选：可以在php中添加以下行。ZendGuardLoader配置的ini文件：\n; 禁用许可证检查（出于性能原因）\nzend_loader.disable_licensing&#x3D;0\n\n;6. Zend Guard Loader支持的混淆级别。官方Zend Guard文档中详细介绍了这些级别。0-未启用模糊处理\nzend_loader.obfuscation_level_support&#x3D;3\n\n;7. 许可的Zend产品应在哪里查找产品许可证的路径。有关如何创建许可文件的详细信息，请参阅《Zend Guard用户指南》\nzend_loader.license_path&#x3D;&#x2F;Users&#x2F;michael&#x2F;Project&#x2F;D1M&#x2F;kering_oms&#x2F;config&#x2F;developer.zl\n# &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;以上&#x3D;&#x3D;&#x3D;为&#x3D;&#x3D;&#x3D;添加&#x3D;&#x3D;&#x3D;内容&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</code></pre>\n\n\n\n<h3 id=\"检查-PHP-扩展\"><a href=\"#检查-PHP-扩展\" class=\"headerlink\" title=\"检查 PHP 扩展\"></a>检查 PHP 扩展</h3><p><em>扩展依赖请自行解决</em></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">~ $ php -m | grep -E &#39;gd|mysql|pdo|curl|imagick|redis|Zend&#39; \ncurl\ngd\nimagick\nmysql\nmysqli\nmysqlnd\npdo_dblib\npdo_mysql\npdo_pgsql\npdo_sqlite\nredis\nZend Guard Loader\nZend OPcache\n[Zend Modules]\nZend Guard Loader\nZend OPcache</code></pre>\n\n\n\n<h3 id=\"Nginx-配置文件\"><a href=\"#Nginx-配置文件\" class=\"headerlink\" title=\"Nginx 配置文件\"></a>Nginx 配置文件</h3><pre class=\"line-numbers language-nginx\" data-language=\"nginx\"><code class=\"language-nginx\">server &#123;\n    listen       80;\n    listen  [::]:80;\n    server_name  oms.test;\n    \n    # 访问日志 &#123;更换第①处&#125;\n    access_log  &#x2F;Users&#x2F;michael&#x2F;.nginx&#x2F;servers&#x2F;host.access.log;\n    \n    location &#x2F; &#123;\n        # 项目路径 &#123;更换第②处&#125;\n        root   &#x2F;Users&#x2F;michael&#x2F;Project&#x2F;D1M&#x2F;kering_oms;\n        \n        index  index.php;\n    &#125;\n    \n    location ~ .*\\.php.* &#123;\n        fastcgi_pass   127.0.0.1:9000;\n        fastcgi_index  index.php;\n        fastcgi_param  GATEWAY_INTERFACE  CGI&#x2F;1.1;\n        fastcgi_param  SERVER_SOFTWARE    nginx;\n        fastcgi_param  QUERY_STRING       $query_string;\n        fastcgi_param  REQUEST_METHOD     $request_method;\n        fastcgi_param  CONTENT_TYPE       $content_type;\n        fastcgi_param  CONTENT_LENGTH     $content_length;\n        # &#123;更换第③处&#125;\n        fastcgi_param  SCRIPT_FILENAME    &#x2F;Users&#x2F;michael&#x2F;Project&#x2F;D1M&#x2F;kering_oms$fastcgi_script_name;\n        \n        fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;\n        fastcgi_param  REQUEST_URI        $request_uri;\n        fastcgi_param  DOCUMENT_URI       $document_uri;\n        fastcgi_param  DOCUMENT_ROOT      $document_root;\n        fastcgi_param  SERVER_PROTOCOL    $server_protocol;\n        fastcgi_param  REMOTE_ADDR        $remote_addr;\n        fastcgi_param  REMOTE_PORT        $remote_port;\n        fastcgi_param  SERVER_ADDR        $server_addr;\n        fastcgi_param  SERVER_PORT        $server_port;\n        fastcgi_param  SERVER_NAME        $server_name;\n        fastcgi_param  REDIRECT_STATUS    200;\n        # 需要支持 PATH_INFO\n        set $real_script_name $fastcgi_script_name;\n        if ($fastcgi_script_name ~ &quot;^(.+?\\.php)(&#x2F;.+)$&quot;) &#123;\n            set $real_script_name $1;\n            set $path_info $2;\n        &#125;\n        # &#123;更换第④处&#125;\n        fastcgi_param SCRIPT_FILENAME &#x2F;Users&#x2F;michael&#x2F;Project&#x2F;D1M&#x2F;kering_oms&#x2F;$real_script_name;\n        \n        fastcgi_param SCRIPT_NAME $real_script_name;\n        fastcgi_param PATH_INFO $path_info;\n    &#125;\n&#125;</code></pre>\n\n<p>配置并验证hosts域名</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"># 检验Nginx配置\nnginx -t\n# 重启Nginx服务\nbrew services restart nginx\n\n# 映射hosts域名\nvim &#x2F;etc&#x2F;hosts\n127.0.0.1 oms.test\n\n# 验证\nping oms.test</code></pre>\n\n\n\n<h3 id=\"MySQL建库\"><a href=\"#MySQL建库\" class=\"headerlink\" title=\"MySQL建库\"></a>MySQL建库</h3><pre class=\"line-numbers language-mysql\" data-language=\"mysql\"><code class=\"language-mysql\">CREATE DATABASE IF NOT EXISTS &#96;kering_oms&#96; DEFAULT CHARSET utf8 COLLATE utf8_general_ci;</code></pre>\n\n<p>验证数据库</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">mysql -uroot -p\n\nmysql&gt; show databases;</code></pre>\n\n\n\n<h3 id=\"部署OMS\"><a href=\"#部署OMS\" class=\"headerlink\" title=\"部署OMS\"></a>部署OMS</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"># 第①处注释 @ D1M&#x2F;kering_oms&#x2F;app&#x2F;setup&#x2F;check.php:155-163\n&#x2F;*if (check_pathinfo()) &#123;*&#x2F;\n    $url &#x3D; $_COOKIE[&#39;LOCAL_SETUP_URL&#39;];\n    setCookie(&#39;LOCAL_SETUP_URL&#39;, &#39;&#39;, 0, &#39;&#x2F;&#39;);\n    Header(&#39;Location: &#39; . $url);    &#x2F;&#x2F;todo:进入安装流程\n    exit;\n&#x2F;*&#125; else &#123;\n    Header(&#39;Location: view&#x2F;notice_pathinfo.html&#39;);   &#x2F;&#x2F;todo:不支持pathinfo，警告页\n    exit;\n&#125;*&#x2F;\n\n# 第②处注释 @ D1M&#x2F;kering_oms&#x2F;app&#x2F;entermembercenter&#x2F;controller&#x2F;register.php:12\n&#x2F;*header(&quot;HTTP&#x2F;1.1 403 XSS OR CSRF &quot;); exit;*&#x2F;\n\n# 第③处新增 @ D1M&#x2F;kering_oms&#x2F;config&#x2F;config.php:155\ndefine(&#39;CUSTOM_CORE_DIR&#39;, ROOT_DIR . &#39;&#x2F;custom&#39;);</code></pre>\n\n\n\n<h3 id=\"shopexID\"><a href=\"#shopexID\" class=\"headerlink\" title=\"shopexID\"></a>shopexID</h3><p>账号：<code>88180401883225</code></p>\n<p>密码：<code>d1m1234</code></p>\n<h3 id=\"结尾\"><a href=\"#结尾\" class=\"headerlink\" title=\"结尾\"></a>结尾</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"># 项目根目录下，初始化项目代码\n~&#x2F;Project&#x2F;D1M&#x2F;kering_oms&lt;master!2?16&gt; \n$ git reset --hard</code></pre>","text":"[TOC] OMS本地环境部署(MacOS)初始化项目代码mkdir -p &#x2F;Users&#x2F;michael&#x2F;Project&#x2F;D1M cd &#x2F;Users&#x2F;michael&#x2F;Project&#x2F;D1M git c...","link":"","photos":[],"count_time":{"symbolsCount":"6.4k","symbolsTime":"6 mins."},"categories":[{"name":"OMS","slug":"OMS","count":1,"path":"api/categories/OMS.json"}],"tags":[{"name":"商派OMS","slug":"商派OMS","count":1,"path":"api/tags/商派OMS.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#OMS%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2-MacOS\"><span class=\"toc-text\">OMS本地环境部署(MacOS)</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">初始化项目代码</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8brew%E5%AE%89%E8%A3%85%E6%9C%8D%E5%8A%A1%E7%8E%AF%E5%A2%83\"><span class=\"toc-text\">使用brew安装服务环境</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8pecl%E5%AE%89%E8%A3%85PHP%E6%89%A9%E5%B1%95\"><span class=\"toc-text\">使用pecl安装PHP扩展</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%A3%80%E6%9F%A5-PHP-%E6%89%A9%E5%B1%95\"><span class=\"toc-text\">检查 PHP 扩展</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Nginx-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">Nginx 配置文件</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#MySQL%E5%BB%BA%E5%BA%93\"><span class=\"toc-text\">MySQL建库</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%83%A8%E7%BD%B2OMS\"><span class=\"toc-text\">部署OMS</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#shopexID\"><span class=\"toc-text\">shopexID</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%BB%93%E5%B0%BE\"><span class=\"toc-text\">结尾</span></a></li></ol></li></ol>","author":{"name":"Michael","slug":"michael","avatar":"https://cdn.jsdelivr.net/gh/mikeah2011/oss@main/uPic/blog_logo.jpeg","link":"/","description":"知我所能者，我所能者，尽善尽美；<br/> <br/> 知我所不能者，我所不能者，虚怀若谷。","socials":{"github":"https://github.com/mikeah2011","twitter":"","stackoverflow":"https://stackoverflow.com/users/11422545/mikeah2011","wechat":"","qq":"","weibo":"https://weibo.com/u/2383628417","zhihu":"https://www.zhihu.com/people/michael-12-18","csdn":"https://blog.csdn.net/weixin_41273562","juejin":"https://juejin.cn/user/4389711549044269","customs":{}}},"mapped":true,"prev_post":{"title":"JetBrains系列产品激活方法","uid":"77838cf99340489be1fbf36de93e7511","slug":"Other/JetBrains系列产品激活方法","date":"2022-10-20T07:05:07.000Z","updated":"2022-11-11T02:02:12.582Z","comments":true,"path":"api/articles/Other/JetBrains系列产品激活方法.json","keywords":null,"cover":[],"text":"首先，自行下载JetBrains的产品，通常推荐JetBrains ToolBox。 其次，访问网站选择对当前网络环境访问效率最好的域名站点。 下载&#96;&#96;jetbra.zip包，首行第一句话就是下载。查看readme.txt&#96;，有具体破解步骤。 解压后直接双...","link":"","photos":[],"count_time":{"symbolsCount":251,"symbolsTime":"1 mins."},"categories":[{"name":"PhpStorm","slug":"PhpStorm","count":2,"path":"api/categories/PhpStorm.json"}],"tags":[{"name":"JetBrains Tools","slug":"JetBrains-Tools","count":1,"path":"api/tags/JetBrains-Tools.json"}],"author":{"name":"Michael","slug":"michael","avatar":"https://cdn.jsdelivr.net/gh/mikeah2011/oss@main/uPic/blog_logo.jpeg","link":"/","description":"知我所能者，我所能者，尽善尽美；<br/> <br/> 知我所不能者，我所不能者，虚怀若谷。","socials":{"github":"https://github.com/mikeah2011","twitter":"","stackoverflow":"https://stackoverflow.com/users/11422545/mikeah2011","wechat":"","qq":"","weibo":"https://weibo.com/u/2383628417","zhihu":"https://www.zhihu.com/people/michael-12-18","csdn":"https://blog.csdn.net/weixin_41273562","juejin":"https://juejin.cn/user/4389711549044269","customs":{}}}},"next_post":{"title":"Redis常见的问题及方案","uid":"c7c9df441ac26b0eb6f306a3696b3570","slug":"02_Redis/Redis","date":"2022-08-20T08:05:07.000Z","updated":"2022-10-06T07:23:27.643Z","comments":true,"path":"api/articles/02_Redis/Redis.json","keywords":null,"cover":[],"text":"为了便于大家查找问题，了解全貌，整理个目录，我们可以快速全局了解关于Redis 缓存，面试官一般喜欢问哪些问题？ 接下来，我们逐条来看看每个问题及解决方案 Redis 有哪些特性？ 性能高， 读的速度是100000次&#x2F;s，写的速度是80000次&#x2F;s 数据持久化...","link":"","photos":[],"count_time":{"symbolsCount":"5.8k","symbolsTime":"5 mins."},"categories":[{"name":"Redis","slug":"Redis","count":10,"path":"api/categories/Redis.json"}],"tags":[{"name":"redis","slug":"redis","count":10,"path":"api/tags/redis.json"}],"author":{"name":"Michael","slug":"michael","avatar":"https://cdn.jsdelivr.net/gh/mikeah2011/oss@main/uPic/blog_logo.jpeg","link":"/","description":"知我所能者，我所能者，尽善尽美；<br/> <br/> 知我所不能者，我所不能者，虚怀若谷。","socials":{"github":"https://github.com/mikeah2011","twitter":"","stackoverflow":"https://stackoverflow.com/users/11422545/mikeah2011","wechat":"","qq":"","weibo":"https://weibo.com/u/2383628417","zhihu":"https://www.zhihu.com/people/michael-12-18","csdn":"https://blog.csdn.net/weixin_41273562","juejin":"https://juejin.cn/user/4389711549044269","customs":{}}}}}