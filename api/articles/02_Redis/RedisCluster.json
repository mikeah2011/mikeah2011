{"title":"","uid":"f73a8e23e6f6f669cf99c7dba8fa0722","slug":"02_Redis/RedisCluster","date":"2022-10-05T13:38:02.008Z","updated":"2022-10-05T13:38:02.009Z","comments":true,"path":"api/articles/02_Redis/RedisCluster.json","keywords":null,"cover":[],"content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>  Redis Cluster</p></blockquote>\n<p><img src=\"https://cdn.jsdelivr.net/gh/mikeah2011/oss@main/uPic/image-20221004222258747.png\" alt=\"image-20221004222258747\"></p>\n<p>hash(key) % 16384 &#x3D; slot 哈希槽 &#x3D; hash(key) &amp; 2^n^</p>\n<p>[0-5460] 、 [5461-10922]、[10923-16383]</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">创建RedisCluster配置的节点目录</span></span><br><span class=\"line\"><span class=\"meta prompt_\">[root@redis]$ </span><span class=\"language-bash\"><span class=\"built_in\">mkdir</span> -p rediscluster/node800&#123;1,2,3,4,5,6&#125;</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">复制Redis配置到每个节点目录</span></span><br><span class=\"line\"><span class=\"meta prompt_\">[root@redis]$ </span><span class=\"language-bash\"><span class=\"built_in\">cp</span> redis-5.0.2/redis.conf rediscluster/node8001/</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">修改节点配置</span></span><br><span class=\"line\"><span class=\"meta prompt_\">[root@redis]$ </span><span class=\"language-bash\">vim rediscluster/node8001/redis.conf</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">批量修改</span></span><br><span class=\"line\">:%s/8001/8002/g</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">启动集群配置</span></span><br><span class=\"line\"><span class=\"meta prompt_\">[root@redis]$ </span><span class=\"language-bash\">redis-server rediscluster/800*/redis.conf</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">校验启动情况</span></span><br><span class=\"line\"><span class=\"meta prompt_\">[root@reids]$ </span><span class=\"language-bash\">ps -ef | grep redis</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">集群命令帮助</span></span><br><span class=\"line\"><span class=\"meta prompt_\">[root@redis]$ </span><span class=\"language-bash\">redis-cli --cluster <span class=\"built_in\">help</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">创建集群关系</span></span><br><span class=\"line\"><span class=\"meta prompt_\">[root@redis]$ </span><span class=\"language-bash\">redis-cli -a 111111 --cluster create --cluster-replicas 1 192.168.109.200:8001 192.168.109.200:8002 192.168.109.200:8003 192.168.109.200:8004 192.168.109.200:8005 192.168.109.200:8006</span>  </span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">连接任意一个节点客户端[带-c说明是集群方式 智能客户端]</span></span><br><span class=\"line\"><span class=\"meta prompt_\">[root@redis]$ </span><span class=\"language-bash\">redis-cli -a 111111 -c -h 192.168.109.200 -p 8001</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">验证集群信息</span></span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">cluster info</span> </span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">cluster nodes</span></span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">cluster slots</span></span><br></pre></td></tr></table></figure>\n\n\n\n<table>\n<thead>\n<tr>\n<th>序号</th>\n<th>配置项</th>\n<th>选项</th>\n<th>释义</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1</td>\n<td>cluster-enabled</td>\n<td>yes</td>\n<td>启动集群模式</td>\n</tr>\n<tr>\n<td>2</td>\n<td>port</td>\n<td>8001</td>\n<td>端口</td>\n</tr>\n<tr>\n<td>3</td>\n<td>dir</td>\n<td>&#x2F;usr&#x2F;local&#x2F;redis-cluster&#x2F;8001&#x2F;</td>\n<td>指定数据目录，绝对目录</td>\n</tr>\n<tr>\n<td>4</td>\n<td>cluster-config-file</td>\n<td>nodes-8001.conf</td>\n<td>集群节点信息，hash crc16</td>\n</tr>\n<tr>\n<td>5</td>\n<td>cluster-node-timeout</td>\n<td>5000</td>\n<td>集群节点超时时间,心跳时间</td>\n</tr>\n<tr>\n<td>6</td>\n<td>bind</td>\n<td>#127.0.0.1</td>\n<td>测试需要注释掉，生产需指定配置</td>\n</tr>\n<tr>\n<td>7</td>\n<td>protected-mode</td>\n<td>no</td>\n<td>关闭保护模式</td>\n</tr>\n<tr>\n<td>8</td>\n<td>requirepass</td>\n<td>111111</td>\n<td>redis访问密码</td>\n</tr>\n<tr>\n<td>9</td>\n<td>masterauth</td>\n<td>111111</td>\n<td>集群节点间的访问密码，与上述保持一致</td>\n</tr>\n<tr>\n<td>10</td>\n<td>damonize</td>\n<td>yes</td>\n<td>后台启动</td>\n</tr>\n<tr>\n<td>11</td>\n<td>appendonly</td>\n<td>yes</td>\n<td></td>\n</tr>\n</tbody></table>\n<h3 id=\"Redis-Cluster-注意事项\"><a href=\"#Redis-Cluster-注意事项\" class=\"headerlink\" title=\"Redis Cluster 注意事项\"></a>Redis Cluster 注意事项</h3><ul>\n<li>不完全支持批量操作：mset、mget</li>\n<li>事务不能跨节点支持</li>\n<li>不支持多实例</li>\n<li>key 是最小粒度</li>\n<li>最少 6 个才能保证组成完整高可用的集群</li>\n<li>连接的时候只需要连接 1 台服务器即可。</li>\n<li>如果 1 个主从连接宕机的话，那么集群就宕机了。</li>\n</ul>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># .composer.lock</span></span><br><span class=\"line\"><span class=\"comment\"># ...</span></span><br><span class=\"line\"><span class=\"string\">&quot;require&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"comment\"># ...</span></span><br><span class=\"line\">    <span class=\"string\">&quot;php&quot;</span>: <span class=\"string\">&quot;^7.1.3&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;predis/predis&quot;</span>: <span class=\"string\">&quot;^1.1&quot;</span>,</span><br><span class=\"line\">    <span class=\"comment\"># 如果安装horizon，请注意Redis密码必设且相同</span></span><br><span class=\"line\">    <span class=\"comment\"># config/horizon.php中&#x27;use&#x27;=&gt;&#x27;horizon&#x27;</span></span><br><span class=\"line\">    <span class=\"comment\"># ...</span></span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"><span class=\"comment\"># ...</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># .env</span></span><br><span class=\"line\"><span class=\"comment\"># ...</span></span><br><span class=\"line\">CACHE_DRIVER=redis</span><br><span class=\"line\"><span class=\"comment\"># ...</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\"># cache.php</span></span><br><span class=\"line\"><span class=\"comment\"># ...</span></span><br><span class=\"line\"><span class=\"string\">&#x27;redis&#x27;</span> =&gt; [</span><br><span class=\"line\">    <span class=\"string\">&#x27;driver&#x27;</span>     =&gt; <span class=\"string\">&#x27;redis&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;connection&#x27;</span> =&gt; <span class=\"string\">&#x27;default&#x27;</span>,</span><br><span class=\"line\">],</span><br><span class=\"line\"><span class=\"comment\">#...</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># database.php</span></span><br><span class=\"line\"><span class=\"comment\"># ...</span></span><br><span class=\"line\"><span class=\"string\">&#x27;redis&#x27;</span> =&gt; [</span><br><span class=\"line\">    <span class=\"string\">&#x27;client&#x27;</span>  =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_CLIENT&#x27;</span>, <span class=\"string\">&#x27;predis&#x27;</span>),</span><br><span class=\"line\">    <span class=\"string\">&#x27;options&#x27;</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">&#x27;cluster&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_CLUSTER&#x27;</span>, <span class=\"string\">&#x27;redis&#x27;</span>),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"string\">&#x27;clusters&#x27;</span> =&gt; [</span><br><span class=\"line\">        <span class=\"string\">&#x27;default&#x27;</span> =&gt; [</span><br><span class=\"line\">            [</span><br><span class=\"line\">                <span class=\"string\">&#x27;host&#x27;</span>     =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_HOST_A&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;password&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PASSWORD_A&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;port&#x27;</span>     =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PORT_A&#x27;</span>, <span class=\"number\">6379</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;database&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_DB_A&#x27;</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">            ],</span><br><span class=\"line\">            [</span><br><span class=\"line\">                <span class=\"string\">&#x27;host&#x27;</span>\t   =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_HOST_B&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;password&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PASSWORD_B&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;port&#x27;</span>     =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PORT_B&#x27;</span>, <span class=\"number\">6379</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;database&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_DB_B&#x27;</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">            ],</span><br><span class=\"line\">            [</span><br><span class=\"line\">                <span class=\"string\">&#x27;host&#x27;</span>     =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_HOST_C&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;password&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PASSWORD_C&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;port&#x27;</span>     =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PORT_C&#x27;</span>, <span class=\"number\">6379</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;database&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_DB_C&#x27;</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">            ],</span><br><span class=\"line\">            [</span><br><span class=\"line\">                <span class=\"string\">&#x27;host&#x27;</span>     =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_HOST_D&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;password&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PASSWORD_D&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;port&#x27;</span>     =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PORT_D&#x27;</span>, <span class=\"number\">6379</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;database&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_DB_D&#x27;</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">            ],</span><br><span class=\"line\">            [</span><br><span class=\"line\">                <span class=\"string\">&#x27;host&#x27;</span>     =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_HOST_E&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;password&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PASSWORD_E&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;port&#x27;</span>     =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PORT_E&#x27;</span>, <span class=\"number\">6379</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;database&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_DB_E&#x27;</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">            ],</span><br><span class=\"line\">            [</span><br><span class=\"line\">                <span class=\"string\">&#x27;host&#x27;</span>     =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_HOST_F&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;password&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PASSWORD_F&#x27;</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;port&#x27;</span>     =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_PORT_F&#x27;</span>, <span class=\"number\">6379</span>),</span><br><span class=\"line\">                <span class=\"string\">&#x27;database&#x27;</span> =&gt; <span class=\"title function_ invoke__\">env</span>(<span class=\"string\">&#x27;REDIS_DB_F&#x27;</span>, <span class=\"number\">0</span>),</span><br><span class=\"line\">            ],</span><br><span class=\"line\">        ],</span><br><span class=\"line\">    ],</span><br><span class=\"line\">],</span><br><span class=\"line\"><span class=\"comment\"># ...</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<p>连接池 pool</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>  应用场景</p></blockquote>\n<p>计数器 string incr</p>\n<p>分布式ID生成 incr</p>\n<p>海量数据统计 - bitmap</p>\n<p>会话缓存 key value</p>\n<p>分布式队列&#x2F;阻塞队列 list 双向链表 <code>lpush/rpush</code> <code>rpop/lpop</code>    <code>brpop/blpop</code>阻塞队列</p>\n<p>分布式锁[setnx]</p>\n<p>热键 HotKey  存储 [list] ltrim\t\t用户路由\t\t二级缓存\t\t</p>\n<p>社交类 - 好友推荐、文章 set</p>\n<p>排行榜 sorted_set</p>\n<p>延迟队列 - sorted_set &amp; zadd + zrangbyscore + rem key</p>\n<p>地址服务 [geo]</p>\n<p>布隆过滤器  [0-1]</p>\n","feature":true,"text":" Redis Cluster hash(key) % 16384 &#x3D; slot 哈希槽 &#x3D; hash(key) &amp; 2^n^ [0-5460] 、 [5461-10922]、[10923-16383] 1234567891011121314151617...","link":"","photos":[],"count_time":{"symbolsCount":"4.7k","symbolsTime":"4 mins."},"categories":[],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Redis-Cluster-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9\"><span class=\"toc-text\">Redis Cluster 注意事项</span></a></li></ol>","author":{"name":"Michael","slug":"michael","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"Just Do IT","socials":{"github":"https://github.com/mikeah2011","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/7318914058","zhihu":"https://www.zhihu.com/people/tridiamond","csdn":"https://blog.csdn.net/TriDiamond6","juejin":"https://juejin.cn/user/1873223546578589","customs":{"bilibili":{"icon":"http://localhost:4000/svg/bilibili.svg","link":"https://live.bilibili.com/22619211"},"baidu":{"icon":"iconfont icon-baidu","link":"https://live.bilibili.com/22619211"},"book":{"icon":"far fa-address-book","link":"https://live.bilibili.com/22619211"},"facebook":{"icon":"/svg/facebook.svg","link":"https://facebook.com"}}}},"mapped":true,"prev_post":{"title":"","uid":"f73a8e23e6f6f669cf99c7dba8fa0722","slug":"03_HTTP/网络安全","date":"2022-10-05T13:38:02.012Z","updated":"2022-10-05T13:38:02.012Z","comments":true,"path":"api/articles/03_HTTP/网络安全.json","keywords":null,"cover":null,"text":"网络安全 ​ 被动攻击 ​ 主动攻击 DNS劫持 CSRF攻击 DoS、DDoS、DRDoS攻击 XSS攻击 ","link":"","photos":[],"count_time":{"symbolsCount":55,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Michael","slug":"michael","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"Just Do IT","socials":{"github":"https://github.com/mikeah2011","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/7318914058","zhihu":"https://www.zhihu.com/people/tridiamond","csdn":"https://blog.csdn.net/TriDiamond6","juejin":"https://juejin.cn/user/1873223546578589","customs":{"bilibili":{"icon":"http://localhost:4000/svg/bilibili.svg","link":"https://live.bilibili.com/22619211"},"baidu":{"icon":"iconfont icon-baidu","link":"https://live.bilibili.com/22619211"},"book":{"icon":"far fa-address-book","link":"https://live.bilibili.com/22619211"},"facebook":{"icon":"/svg/facebook.svg","link":"https://facebook.com"}}}},"feature":true},"next_post":{"title":"","uid":"f73a8e23e6f6f669cf99c7dba8fa0722","slug":"01_MySQL/索引/红黑树","date":"2022-10-05T13:38:01.999Z","updated":"2022-10-05T13:38:01.999Z","comments":true,"path":"api/articles/01_MySQL/索引/红黑树.json","keywords":null,"cover":[],"text":"二叉树 - 链表结构 - 相当于全表扫描 大于自己的值，放在右边，比自己小的放在左边 红黑树 - 二叉平衡树 - 数据量大时，树的高度不可控 B-Tree树 ​ 非叶子节点也会存储数据 没有维护双向指针 ​ 树的高度 由非叶子节点 的叶叉树来决定的 ​ 16^n^ &#x3D; ...","link":"","photos":[],"count_time":{"symbolsCount":853,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Michael","slug":"michael","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"Just Do IT","socials":{"github":"https://github.com/mikeah2011","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/7318914058","zhihu":"https://www.zhihu.com/people/tridiamond","csdn":"https://blog.csdn.net/TriDiamond6","juejin":"https://juejin.cn/user/1873223546578589","customs":{"bilibili":{"icon":"http://localhost:4000/svg/bilibili.svg","link":"https://live.bilibili.com/22619211"},"baidu":{"icon":"iconfont icon-baidu","link":"https://live.bilibili.com/22619211"},"book":{"icon":"far fa-address-book","link":"https://live.bilibili.com/22619211"},"facebook":{"icon":"/svg/facebook.svg","link":"https://facebook.com"}}}},"feature":true}}